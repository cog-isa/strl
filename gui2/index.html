<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8">
  <title> тестовая карта </title>
  <script src="./static/js/require.js"></script>
  
    <link rel="stylesheet" href="./static/css/jquery-ui-1.10.4.custom.css"/>  
    <link rel="stylesheet" href="./static/js/lib/bootstrap/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="./static/js/lib/bootstrap-editable/css/bootstrap-editable.css"/>
 </head>
 
 <body>
 		
	<div 	id="workarea" tabindex="-1" 
			style="position:relative;"> <!-- ,было relative///будет absolute ?    onkeydown="S.containerInput(event);"  -->
		
		<!--для масштаба. попробовать без контейнера.. с workarea??		--->	
        <div 	id="container"  
				style="cursor: default; 
				position: relative;	
				transform: scale({{scale}});
				transform-origin: left top;">
	
					
			<svg 	height="3000px"
					version="1.1"
					width="5000px"
					xmlns="http://www.w3.org/2000/svg" 
					style="	overflow: auto;  
							position: fixed; 
							
							left:5px;
							top:5px;
							
							background-color:rgba(20, 20, 190, 0.10);"
			>
			</svg> 
			
            <div id="nodes"
				 style="position:relative;"		 
			>  
			
			<!-- offset что бы все отображалось корректно -->
                <div 	al-repeat="nodeid in helper.nodesIDs()" /*здесь важно чтобы nodes[] node - это в коде есть*/                       
						strl-agent=""
						
						id="{{nodes[nodeid].id}}" class="agent"
						
						style="
							display:inline-block;
							position: relative;
							left:{{nodes[nodeid].posx}}px;
							top: {{nodes[nodeid].posy}}px;

							
							background-size: 15px 15px;
							
							visibility: {{nodes[nodeid].isVisible ? 'visible' : 'hidden'}};
							"
                        
                        tabindex="-1"
                        
                        al-click="nodes[nodeid]._select()"
						
                        al-css="nodeselected: selectednode.id==nodes[nodeid].id"
                    >

                        <div class ="node_icon"
							al-repeat="icon in nodes[nodeid].icons"
							title="{{icon.hint}}"
							al-if="icon.img">
                            <img al-src="{{icon.img}}" ></img>
                        </div>
						
						<!--название агента,  ограничить видимую длинну -->
                        <div class="ediatable text_cut">
                            <span 	class="nodetitle"
									style="border-bottom: dashed 1px #0088cc;
										   width: 1px">
							</span>
							
							<!-- info circle -->
							<span 	class="info_circle"
									style="float:right; width:15px; height:15px;
											background-image:url(/static/img/glyphicons_free/glyphicons/png/glyphicons_195_circle_info.png);
											background-size: 15px 15px;
											
											opacity: 0.5;"    >
							</span>
							
                        </div>
                       
                </div>
            </div>	
			
			<div id="nodes2"
				 style="position:relative;"		 
			>
			<div 	al-repeat="nodeid in helper2.nodesIDs()" /*здесь важно чтобы nodes2[] node - это в коде есть*/                       
						strl-wall=""
						
						id="{{nodes2[nodeid].id}}" class="wall"
						
						style="
							display:inline-block;
							position: relative;
							left:{{nodes2[nodeid].posx}}px;
							top: {{nodes2[nodeid].posy}}px;

							
							background-size: 15px 15px;
							
							visibility: {{nodes2[nodeid].isVisible ? 'visible' : 'hidden'}};
							"
                        
                        tabindex="-1"
                        
                        al-click="nodes2[nodeid]._select()"
						
                        al-css="nodeselected: selectednode.id==nodes2[nodeid].id"
                    >

                        <div class ="node_icon"
							al-repeat="icon in nodes2[nodeid].icons"
							title="{{icon.hint}}"
							al-if="icon.img">
                            <img al-src="{{icon.img}}" ></img>
                        </div>
						
						<!--название агента,  ограничить видимую длинну -->
                        <div class="ediatable text_cut">
                            <span 	class="nodetitle"
									style="border-bottom: dashed 1px #0088cc;
										   width: 1px">
							</span>
							
							<!-- info circle -->
							<span 	class="info_circle"
									style="float:right; width:15px; height:15px;
											background-image:url(/static/img/glyphicons_free/glyphicons/png/glyphicons_195_circle_info.png);
											background-size: 15px 15px;
											
											opacity: 0.5;"    >
							</span>
							
                        </div>
                       
                </div>
			</div>
		</div>
		
	</div>
  
  <script>
		require(["./static/js/jquery-1.9.1.js" /*for jq_ui*/, ], function(_jquery){
			require([
						"./static/js/jquery-ui.js", 
						'./agent.js',
						'./wall.js',
												
						// bootstrap 	 
						'./static/js/lib/bootstrap/js/bootstrap.min.js',
						'./static/js/lib/bootstrap-editable/js/bootstrap-editable.min.js',
                        './static/js/tree7_scripts.js',
                        // simpletip
                        './static/js/lib/simpletip/jquery.simpletip-1.3.1.pack.js',
					],
					function( _jq_ui, agent, wall ){
						// CONFIGURE SCOPE AND BIND to BODY
						var tag = document.querySelector('body'); 

						var scope = alight.Scope();
						
						// init scope
						wall.wall_app(scope);
						agent.agent_app(scope);
						
						alight.applyBindings(scope, tag);						
			});
		});
  </script>
</body>
 
</html>